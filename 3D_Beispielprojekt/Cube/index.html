<!DOCTYPE HTML>
<html>
	<head>
		<meta charset="utf-8"/>
		<title>Zettel 6 - Aufgabe 1</title>
		
		<script id="vertex-shader" type="x-shader/x-vertex">
			attribute vec4 vPosition;
			attribute vec4 vColor;
			attribute vec3 vNormal;
						
			uniform mat4 modelMatrix;
			uniform mat4 viewMatrix;
			uniform mat4 projectionMatrix;
			uniform mat4 invertedTransposedT;

			//Koeffizienten, zur Vereinfachung konstant und alle gleich
			float ka = 0.3;
			float kd = 0.5;
			float ks = 0.75;

			vec4 ia = vec4(0.3,1.0,0.8,1.0);
			vec4 id = vec4(0.3,0.5,0.8,1.0);
			vec4 is = vec4(1.0,0.0,0.8,1.0);

			//vec4 Lpos = (0,0,0,1);
			//vec4 L = 
			//vec4 N = normalize(vNormal);
			//vec4 V = normalize(vec4(0,0,0,1) - vNormal);

			//vec4 ambient = ia * ka;
			//vec4 diffus = id * ka * max(0,dot(N,));


			varying vec4 fColor;

			// Aus den Mozilla-Docs
			varying vec3 vLighting;

			
			void main()
			{
				gl_Position = projectionMatrix * viewMatrix * modelMatrix * vPosition;

				vec4 lichtpos = normalize(vec4(1,0.5,0.5,0));
				
				vec4 vertexNormale = projectionMatrix * viewMatrix * modelMatrix * vec4(vNormal,0);

				vec4 l = normalize(lichtpos - gl_Position);
				vec4 n = normalize(vertexNormale - gl_Position);
				vec4 r = normalize(reflect(l,n));
				vec4 v = normalize(vec4(0,0,0,0) - gl_Position);
				float x = 5.0;

				vec4 ambient = ia * ka;
				vec4 diffus = id * kd * max(0.0, dot(n,l));
				vec4 spekular = is * ks * pow(float(max(0.0,dot(r,v))),x);

				fColor = ambient + diffus + spekular;  
					



				// Aus den Mozilla-Docs
				// Intensität des ambienten Lichtes
				//vec3 ambientLight = vec3(0.1, 0.1, 0.1);
        		// Intensität des diffusen Lichtes
        		//vec3 Idiffus = vec3(1, 1, 1); 
        		// Quelle des diffusen Lichtes? Keine erleuchtung, wenn 0,0,0.
        		//vec3 L = vec3(0, 0, -0.4);
        
    			//vec4 transformedNormal = projectionMatrix * vec4(aVertexNormal, 1.0);
        
       			//float spekular = max(dot(transformedNormal.xyz, L), 0.0);

        		//vLighting = ambientLight + (Idiffus * spekular);


        		//fColor = vec4(vLighting,1.0) * vColor;
        		

			}
		</script>
		<script id="fragment-shader" type="x-shader/x-fragment">
			precision mediump float;
			
			varying vec4 fColor;

			varying vec3 vLighting;

			
			void main()
			{
				gl_FragColor = fColor;
			}
		</script>

		<script type="text/javascript" src="../Common/webgl-utils.js">
		</script>
		<script type="text/javascript" src="../Common/initShaders.js">
		</script>
		<script type="text/javascript" src="../Common/gl-matrix.js">
		</script>
		<script type="text/javascript" src="cube.js">
		</script>
		<!-- Der Cube hat bis jetzt noch keine Verwendung -->
		<script type="text/plain" id="cube">
			####
			#
			#   OBJ File Generated by Blender
			#
			####
			o my_cube.obj
			v 1 1 1
			v -1 1 1
			v -1 -1 1
			v 1 -1 1
			v 1 1 -1
			v -1 1 -1
			v -1 -1 -1
			v 1 -1 -1
			vn 0 0 1
			vn 1 0 0
			vn -1 0 0
			vn 0 0 -1
			vn 0 1 0
			vn 0 -1 0
			f 1//1 2//1 3//1
			f 3//1 4//1 1//1
			f 5//2 1//2 4//2
			f 4//2 8//2 5//2
			f 2//3 6//3 7//3
			f 7//3 3//3 2//3
			f 7//4 8//4 5//4
			f 5//4 6//4 7//4
			f 5//5 6//5 2//5
			f 2//5 1//5 5//5
			f 8//6 4//6 3//6
			f 3//6 7//6 8//6
		</script>
	</head>
	<body>
		<canvas id="gl-canvas" width="512" height="512">
			If you see this, your browser doesn't support WebGL.
		</canvas>
		
	</body>
</html>
